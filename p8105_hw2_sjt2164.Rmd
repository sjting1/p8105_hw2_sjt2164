---
title: "Homework 2"
output: github_document
---
_Note: This homework uses the `tidyverse` and `dplyr` libraries._
```{r setup, include = FALSE}
library(tidyverse)
library(dplyr)
library(readxl)
```

## Problem 1

```{r data, include = FALSE}
nyctransit_df = read_csv("./data/NYC_Transit_Subway_Entrance_And_Exit_Data.csv")
nyctransit_df #1,868 entries and 32 columns.
```

The `nyctransit_df` dataset (`r ncol(nyctransit_df)` columns x `r nrow(nyctransit_df)` rows) was created based on the _"NYC_Transit_Subway_Entrance_And_Exit_Data.csv"_ file.

```{r summary, include = FALSE}
summary(nyctransit_df)
nyctransit_df = janitor::clean_names(nyctransit_df) #transform variable names to snake case
```

After reading the `nyctransit_df` dataset and taking a look at its 32 variables with `summary(nyctransit_df)`, I applied the snake case convention to the variable names using `clean_names` from the `janitor` package. 

```{r select, include = FALSE}
nyctransit_q1 = 
  select(nyctransit_df, line:entry, vending, ada) |>
   mutate(
     entry = ifelse(entry == "YES", TRUE, FALSE)
     ) #convert entry to logical variable

nyctransit_q1 #1,868 entries and 19 columns. 11 character, 2 logical and 6 double variables
summary(nyctransit_q1)
```

Using the `select()` function, I selected my variables of interest and converted the `entry` variable in this dataset from character to a logical variable. 

The resulting `nyctransit_q1` dataset (`r ncol(nyctransit_q1)` columns x `r nrow(nyctransit_q1)` rows) has 19 variables (11 characters, 2 logicals, and 6 doubles).


#### The 19 Variables in `nyctransit_q1`

_Note: To see the categories in some of the character and double variables, I transformed them into factors and created the `nyctransit_fc` dataset. Then I used the `levels(pull())` function to look at the categories._

```{r char to fact, include = FALSE}
nyctransit_fc = 
  nyctransit_q1 |>
    mutate(
      line_fc = as.factor(line), #mutate to see the categories
      station_name_fc = as.factor(station_name),
      route1_fc = as.factor(route1),
      route2_fc = as.factor(route2),
      route3_fc = as.factor(route3),
      route4_fc = as.factor(route4),
      route5_fc = as.factor(route5),
      route6_fc = as.factor(route6),
      route7_fc = as.factor(route7),
      route8_fc = as.factor(route8), # trains 1,4, and 5 
      route9_fc = as.factor(route9), # trains 2 and 5
      route10_fc = as.factor(route10), # train 3
      route11_fc = as.factor(route11), # train 7
      entrance_type_fc = as.factor(entrance_type),
      vending_fc = as.factor(vending),
      )

summary(nyctransit_fc)
```

```{r levels, include = FALSE}
levels(pull(nyctransit_fc,line_fc))
levels(pull(nyctransit_fc,station_name_fc))
levels(pull(nyctransit_fc,route1_fc))
levels(pull(nyctransit_fc,route2_fc))
levels(pull(nyctransit_fc,route3_fc))
levels(pull(nyctransit_fc,route4_fc))
levels(pull(nyctransit_fc,route5_fc))
levels(pull(nyctransit_fc,route6_fc))
levels(pull(nyctransit_fc,route7_fc))
levels(pull(nyctransit_fc,entrance_type_fc))
levels(pull(nyctransit_fc,vending_fc))
```

In the `nyvtransit_q1` dataset, the 11 character variables include: `line` (36 different lines), `station_name` (356 different names), `route1` to `route7`, `entrance_type` (`r levels(pull(nyctransit_fc,entrance_type_fc))`), and `vending` (y/n).

The 2 logical variables are `ada`, which indicates whether it is ADA compliant, and `entry`.

The 6 double variables are `station_latitude`, `station_longitude`, and `route8` to `route11`.
  
The data in `nyctransit_q1` is not tidy. For example, Routes 8 to 11 were entered as doubles but it is a categorical variable. Similarly, character variables such as `line`, `entrance_type`, `vending`, and `route1` to `route7` are categorical variables and could be converted to factors.

#### Problem 1 Question Answers

```{r station, include = FALSE}
levels(pull(nyctransit_fc,station_name_fc)) #can also use distinct function

station = distinct(nyctransit_fc,station_name) #another option: 356 stations
```

There are 356 distinct stations. 73 out of the 356 stations are ADA compliant. Of the 36 distinct stations that have entrances/exits without vending, 16 (44.44%) allow entrance. 

```{r ada stations, include = FALSE}
nyctransit_ada = filter(nyctransit_fc, ada == "TRUE")
ada = distinct(nyctransit_ada,station_name) #73 distinct stations
```

```{r vending, include = FALSE}
nyctransit_ent = filter(nyctransit_ada, vending_fc == "NO") #36 stations with entrance/exits w/o vending
summary(nyctransit_ent) #Entry: 20 FALSE and 16 TRUE
```

#### Reformatting Data

```{r reformat, include = FALSE}
reformat = 
  nyctransit_fc |>
    mutate(
      route8 = as.character(route8_fc), 
      route9 = as.factor(route9_fc),
      route10 = as.factor(route10_fc),
      route11 = as.factor(route11_fc)) |>
    pivot_longer(
    cols = route1:route11, 
    names_to = "route_number",
    names_prefix = "route_number",
    values_to = "train") |>
    filter(train == "A"
  ) 
```

```{r trainA stations, include = FALSE}
trainA_ada = distinct(reformat, station_name_fc)
```

After reformatting the data, we find that 56 distinct stations serve the A train. 

```{r trainA ada, include = FALSE}
ada_compli = reformat |>
    filter(ada == TRUE) |>
    distinct(station_name)

ada_compli #16 distinct ADA compliant stations serve A train
```

Of the stations that serve the A train, 16 are ADA compliant.

## Problem 2

Problem 2 uses the _"202309 Trash Wheel Collection Data"_ xlsx file from Mr. Trash Wheel. The Mr. Trash Wheel sheet has been read, cleaned, and imported as `mr_trash`.

```{r mrtrash setup, include = FALSE}
mr_trash = read_excel("data/202309 Trash Wheel Collection Data.xlsx", sheet = "Mr. Trash Wheel", n_max = 584) |>
janitor::clean_names() |>
  select(dumpster:homes_powered) |> 
  mutate(sports_balls = as.integer(sports_balls)) 

summary(mr_trash) #584c x 14c
```

The Professor Trash Wheel sheet has been read, cleaned, and imported as `prof_trash`.
```{r proftrash setup, include = FALSE}
prof_trash = read_excel("data/202309 Trash Wheel Collection Data.xlsx", sheet = "Professor Trash Wheel", n_max = 106) |>
janitor::clean_names() 

summary(prof_trash) #106r x 13c
```

The Gwynnda Trash Wheel sheet has been read, cleaned, and imported as `gwynnda_trash`.
```{r gwynndatrash setup, include = FALSE}
gwynnda_trash = read_excel("data/202309 Trash Wheel Collection Data.xlsx", sheet = "Gwynnda Trash Wheel", n_max = 157) |>
janitor::clean_names() 

summary(gwynnda_trash) #157r x 12c
```


